<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FSA JAMB PRO v5.1 - Official CBT</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root { --jamb-blue: #0d47a1; --accent: #ffd600; --bg: #f4f7f6; --success: #28a745; }
        body { background: linear-gradient(135deg, var(--bg), #e8f4fd); font-family: 'Segoe UI', sans-serif; overflow-x: hidden; }
        .header { background: linear-gradient(135deg, var(--jamb-blue), #1976d2); color: white; padding: 12px; border-bottom: 4px solid var(--accent); position: sticky; top: 0; z-index: 1050; }
        
        .subject-card { background: white; border-radius: 16px; padding: 20px; cursor: pointer; border: 2px solid transparent; text-align: center; transition: all 0.3s; box-shadow: 0 6px 20px rgba(0,0,0,0.1); height: 100%; position: relative; overflow: hidden; }
        .subject-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px; background: var(--jamb-blue); transform: scaleX(0); transition: 0.3s; }
        .subject-card:hover { transform: translateY(-5px); box-shadow: 0 12px 30px rgba(0,0,0,0.15); }
        .subject-card.selected { border-color: var(--success); background: linear-gradient(135deg, #f0fff4, white); }
        .subject-card.selected::before { transform: scaleX(1); background: var(--success); }

        .subject-tabs { background: white; border-bottom: 3px solid #eee; position: sticky; top: 55px; z-index: 1000; display: flex; overflow-x: auto; scrollbar-width: none; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .tab-item { flex: 1; text-align: center; padding: 15px 10px; cursor: pointer; border-bottom: 3px solid transparent; font-weight: 600; color: #666; min-width: 100px; white-space: nowrap; transition: 0.3s; }
        .tab-item.active { border-bottom-color: var(--jamb-blue); color: var(--jamb-blue); background: linear-gradient(135deg, #eef2f7, white); }

        .progress-bar-container { background: #e9ecef; height: 8px; border-radius: 4px; margin-bottom: 15px; overflow: hidden; }
        .progress-bar { height: 100%; background: linear-gradient(90deg, var(--success), #20c997); transition: width 0.5s; border-radius: 4px; }

        .question-card { background: white; border-radius: 12px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); margin-bottom: 20px; }
        .option { display: block; width: 100%; padding: 15px; margin-bottom: 10px; border: 2px solid #e9ecef; border-radius: 10px; text-align: left; background: white; transition: all 0.3s; cursor: pointer; font-size: 1rem; }
        .option:hover { border-color: var(--jamb-blue); transform: translateX(5px); box-shadow: 0 4px 12px rgba(13,71,161,0.15); }
        .option.selected { background: linear-gradient(135deg, var(--jamb-blue), #1976d2); color: white; border-color: var(--jamb-blue); transform: scale(1.02); }
        
        #calc-panel { position: fixed; top: 0; right: -300px; width: 280px; height: 100%; background: #222; color: white; transition: 0.4s; z-index: 2000; padding: 25px; box-shadow: -8px 0 25px rgba(0,0,0,0.4); }
        #calc-panel.open { right: 0; }
        .calc-btn { width: 50px; height: 50px; margin: 2px; font-weight: bold; }

        .score-circle { width: 160px; height: 160px; border-radius: 50%; border: 12px solid; display: flex; align-items: center; justify-content: center; margin: 25px auto; font-size: 3.5rem; font-weight: 800; color: white; position: relative; }
        .score-circle.gold { border-color: #ffd700; background: #ffd700; color: #333; }
        .score-circle.green { border-color: var(--success); background: var(--success); }
        .score-circle.orange { border-color: #fd7e14; background: #fd7e14; }
        .score-circle.red { border-color: #dc3545; background: #dc3545; }

        .fab { position: fixed; bottom: 25px; right: 25px; width: 60px; height: 60px; border-radius: 50%; background: var(--jamb-blue); color: white; border: none; font-size: 1.5rem; z-index: 1500; }
        .pulse { animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
    </style>
</head>
<body>

<div class="header d-flex justify-content-between align-items-center shadow-lg">
    <div class="fw-bold fs-4"><i class="fas fa-graduation-cap me-2"></i>FSA-JAMB v5.1</div>
    <div id="timer" class="badge bg-dark fs-5 px-3 py-2 shadow">02:00:00</div>
    <div>
        <button class="btn btn-sm btn-warning me-1 fw-bold" onclick="toggleCalc()"><i class="fas fa-calculator"></i></button>
    </div>
</div>

<div id="calc-panel">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h5 class="mb-0">Calculator</h5>
        <button class="btn btn-sm btn-outline-light" onclick="toggleCalc()">âœ•</button>
    </div>
    <input type="text" id="calc-display" class="form-control mb-3 text-end fs-4 fw-bold" readonly>
    <div class="row g-1">
        <div class="col-3"><button class="btn btn-light calc-btn w-100" onclick="calcInput('7')">7</button></div>
        <div class="col-3"><button class="btn btn-light calc-btn w-100" onclick="calcInput('8')">8</button></div>
        <div class="col-3"><button class="btn btn-light calc-btn w-100" onclick="calcInput('9')">9</button></div>
        <div class="col-3"><button class="btn btn-danger calc-btn w-100" onclick="calcInput('C')">C</button></div>
        <div class="col-3"><button class="btn btn-light calc-btn w-100" onclick="calcInput('4')">4</button></div>
        <div class="col-3"><button class="btn btn-light calc-btn w-100" onclick="calcInput('5')">5</button></div>
        <div class="col-3"><button class="btn btn-light calc-btn w-100" onclick="calcInput('6')">6</button></div>
        <div class="col-3"><button class="btn btn-warning calc-btn w-100" onclick="calcInput('*')">Ã—</button></div>
        <div class="col-3"><button class="btn btn-light calc-btn w-100" onclick="calcInput('1')">1</button></div>
        <div class="col-3"><button class="btn btn-light calc-btn w-100" onclick="calcInput('2')">2</button></div>
        <div class="col-3"><button class="btn btn-light calc-btn w-100" onclick="calcInput('3')">3</button></div>
        <div class="col-3"><button class="btn btn-warning calc-btn w-100" onclick="calcInput('-')">-</button></div>
        <div class="col-3"><button class="btn btn-light calc-btn w-100" onclick="calcInput('0')">0</button></div>
        <div class="col-3"><button class="btn btn-warning calc-btn w-100" onclick="calcInput('/')">Ã·</button></div>
        <div class="col-3"><button class="btn btn-warning calc-btn w-100" onclick="calcInput('+')">+</button></div>
        <div class="col-3"><button class="btn btn-success calc-btn w-100" onclick="calcInput('=')">=</button></div>
    </div>
</div>

<div class="container mt-5">
    <div id="setup-screen">
        <div class="text-center mb-5">
            <h2 class="fw-bold text-primary mb-3">Student Dashboard</h2>
            <p class="lead text-muted">Select English + 3 Subjects</p>
        </div>
        <div class="row g-4 mb-5" id="subject-grid"></div>
        <div class="text-center">
            <button id="start-btn" class="btn btn-primary btn-lg w-100 py-4 fw-bold disabled pulse" style="border-radius: 25px;" onclick="beginExam()">START EXAMINATION</button>
            <div id="selection-count" class="mt-3 text-muted"></div>
        </div>
    </div>

    <div id="exam-screen" style="display:none;">
        <div class="subject-tabs mb-4" id="tab-container"></div>
        <div class="question-card">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h5 id="current-sub-label" class="text-primary fw-bold mb-0">Subject</h5>
                <div>
                    <span id="q-count" class="badge bg-secondary fs-6 px-3 py-2 me-2"></span>
                    <div class="progress-bar-container" style="width: 150px; display: inline-block;">
                        <div class="progress-bar" id="progress-bar" style="width: 0%"></div>
                    </div>
                </div>
            </div>
            <div id="q-container"></div>
            <div class="d-flex justify-content-between mt-5">
                <button class="btn btn-outline-secondary px-4 py-2 fw-bold" onclick="moveQ(-1)">PREV</button>
                <span class="align-self-center text-muted" id="q-nav"></span>
                <button class="btn btn-primary px-4 py-2 fw-bold" onclick="moveQ(1)">NEXT</button>
            </div>
        </div>
        <button class="btn btn-success w-100 mt-5 p-4 fw-bold shadow" style="border-radius: 25px;" onclick="finish()">SUBMIT EXAM</button>
    </div>

    <div id="result-screen" style="display:none;">
        <div class="card border-0 shadow-lg p-5 text-center mx-auto" style="max-width: 600px;">
            <h4>YOUR RESULTS</h4>
            <div class="score-circle gold" id="total-score">0</div>
            <h3 id="status-msg" class="mt-4 mb-4 fw-bold"></h3>
            <div id="breakdown" class="text-start border-top pt-4 mb-5"></div>
            <button class="btn btn-primary w-100 py-3 fw-bold" onclick="location.reload()">RETAKE EXAM</button>
        </div>
    </div>
</div>

<script>
    const allSubs = [
        {id:"English", icon:"ðŸ“š", required: true}, {id:"Mathematics", icon:"ðŸ“"}, {id:"Physics", icon:"âš›ï¸"}, 
        {id:"Chemistry", icon:"ðŸ§ª"}, {id:"Biology", icon:"ðŸ§¬"}, {id:"Government", icon:"ðŸ›ï¸"}, 
        {id:"Crk", icon:"ðŸ“–"}, {id:"Economics", icon:"ðŸ“ˆ"}, {id:"Commerce", icon:"ðŸ›’"}, {id:"Accounting", icon:"ðŸ’¼"}
    ];
    let selected = ["English"], examData = {}, activeSub = "English", activeIdx = 0, userAns = {}, 
        timerInterval, timeLeft = 7200;

    function init() {
        const grid = document.getElementById('subject-grid');
        grid.innerHTML = allSubs.map(s => `
            <div class="col-xl-3 col-lg-4 col-6">
                <div class="subject-card ${selected.includes(s.id)?'selected':''}" onclick="toggle('${s.id}')">
                    <div class="fs-1 mb-2">${s.icon}</div>
                    <div class="h5 fw-bold">${s.id}</div>
                    ${s.required ? '<small class="badge bg-success">Required</small>' : ''}
                </div>
            </div>`).join('');
        document.getElementById('start-btn').classList.toggle('disabled', selected.length < 4);
        document.getElementById('selection-count').innerText = `${selected.length}/4 subjects selected`;
    }

    function toggle(id) {
        if (allSubs.find(s => s.id === id)?.required) return;
        const i = selected.indexOf(id);
        if (i > -1) selected.splice(i, 1); 
        else if (selected.length < 4) selected.push(id);
        init();
    }

    async function beginExam() {
        for (let s of selected) {
            try {
                const res = await fetch(`${s.toLowerCase()}.json`);
                examData[s] = await res.json();
                userAns[s] = new Array(examData[s].length).fill(null);
            } catch(e) { 
                alert(`Error: ${s.toLowerCase()}.json not found!`);
                return; 
            }
        }
        document.getElementById('setup-screen').style.display = 'none';
        document.getElementById('exam-screen').style.display = 'block';
        document.getElementById('tab-container').innerHTML = selected.map(s => 
            `<div class="tab-item" id="tab-${s}" onclick="switchTab('${s}')">${s}</div>`).join('');
        switchTab("English");
        startTimer(7200);
    }

    function switchTab(sName) {
        activeSub = sName; activeIdx = 0;
        document.querySelectorAll('.tab-item').forEach(t => t.classList.remove('active'));
        document.getElementById(`tab-${sName}`).classList.add('active');
        render();
    }

    function render() {
        const q = examData[activeSub][activeIdx];
        document.getElementById('current-sub-label').innerHTML = `<i class="fas fa-${getIcon(activeSub)} me-2"></i>${activeSub}`;
        document.getElementById('q-count').innerText = `${activeIdx + 1}/${examData[activeSub].length}`;
        document.getElementById('progress-bar').style.width = `${((activeIdx+1)/examData[activeSub].length)*100}%`;
        
        let html = q.p ? `<div class="passage-box"><strong>Passage:</strong> ${q.p}</div>` : '';
        html += `<div class="mb-4 fs-4 fw-semibold">${q.q}</div>`;
        q.options.forEach((opt, i) => {
            const isSel = userAns[activeSub][activeIdx] === i;
            html += `<button class="option ${isSel?'selected':''}" onclick="pick(${i})">
                <strong>${String.fromCharCode(65+i)}.</strong> ${opt}</button>`;
        });
        document.getElementById('q-container').innerHTML = html;
    }

    function pick(i) { userAns[activeSub][activeIdx] = i; render(); }
    function moveQ(d) { 
        if (activeIdx + d >= 0 && activeIdx + d < examData[activeSub].length) { 
            activeIdx += d; render(); 
        } 
    }

    function toggleCalc() { document.getElementById('calc-panel').classList.toggle('open'); }
    let calcVal = "";
    function calcInput(v) {
        const d = document.getElementById('calc-display');
        if (v==='C') calcVal = "";
        else if (v==='=') { try { calcVal = eval(calcVal).toString(); } catch { calcVal = "Error"; } }
        else calcVal += v;
        d.value = calcVal;
    }

    function getIcon(s) {
        const icons = {"English":"book","Mathematics":"calculator","Physics":"atom","Chemistry":"flask","Biology":"dna","Government":"landmark","Crk":"bible","Economics":"chart-line","Commerce":"shopping-cart","Accounting":"briefcase"};
        return icons[s] || "file";
    }

    function startTimer(t) {
        timeLeft = t;
        timerInterval = setInterval(() => {
            timeLeft--;
            let h = Math.floor(timeLeft/3600), m = Math.floor((timeLeft%3600)/60), s = timeLeft%60;
            document.getElementById('timer').innerText = `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
            if (timeLeft <= 0) { clearInterval(timerInterval); finish(); }
        }, 1000);
    }

    function finish() {
        if (!confirm("Submit exam?")) return;
        clearInterval(timerInterval);
        let totalScore = 0, report = "";
        selected.forEach(s => {
            let correct = 0;
            examData[s].forEach((q, i) => { if (userAns[s][i] === q.a) correct++; });
            let score = Math.round((correct/examData[s].length)*100);
            totalScore += score;
            report += `<div class="mb-2"><strong>${s}:</strong> ${correct}/${examData[s].length} (${score}%)</div>`;
        });
        let jambScore = Math.round((totalScore/400)*400); // Scale out of 400
        document.getElementById('total-score').innerText = jambScore;
        document.getElementById('total-score').className = `score-circle ${jambScore>=250?'gold':'green'}`;
        document.getElementById('breakdown').innerHTML = report;
        document.getElementById('exam-screen').style.display = 'none';
        document.getElementById('result-screen').style.display = 'block';
    }

    window.onload = init;
</script>
</body>
</html>
